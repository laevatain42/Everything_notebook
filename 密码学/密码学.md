# 古典密码

## 置换与代换

**代换密码：**将明文密码代换为密文字符，顺序不变

e.g. 棋盘密码/凯撒密码

代换密码的数学描述（P明文空间C密文空间K密钥E加密函数D解密函数）

加密函数必须是单射&可逆。

e.g. 仿射密码（aP+b=C）：赋值a/b且互素，最终结果mod26获得结果（此过程需要逆模运算）

e.g. 希尔密码（Hill）其K是mxm矩阵，是一种矩阵运算。矩阵可逆，所以Hill单射且还原

e.g. 维吉尼亚密码（多次移位密码，密钥不同）

------

**置换密码：**将明文字符打乱顺序，字符本身不变

密钥是置换规则，而代换密码的密钥通常是数值或者其他的东西

e.g. 斯巴达卷棍密码/栅栏密码

置换密码是希尔密码的特殊形式

## 古典密码分析

**密码分析：**通过截获的密文推断出明文甚至密钥的过程

Kerckhoff假设：分析者在一直密码体制的前提下破译

密钥空间足够大是密码安全的必要不充分条件

------

**常用攻击模型：**

- 唯密文攻击

最困难的分析条件，只知道密文，可以攻击单表代换和多表代换

通常使用英文字母的频率分析（比如e的频率最高）

有些字母不会出现在一个单词中，可以构成边界，即限制条件

可用于攻破仿射密码

代换密码攻破e之后，可以e的双字母组合继续攻击，然后继续猜测，寻找单词边界。猜测过频率较高的字母后，可以根据规律来进行判定

希尔密码密码分析：无法通过唯密文攻击来分析。

多表代换无法使用频率分析方法进行缝隙，维吉尼亚密码在得知密钥长度m可以分割为m个多表代换来分析。

Kasisk测试法：标出重复的字符结构，求解距离，分解因数，尝试求解密钥。

重合指数法： 单表代换中，密文重合指数与明文相同。通过尝试不同的m来逼近0.065

- 已知明文攻击

可以攻击希尔密码

- 选择明文攻击
- 选择密文攻击（最牛逼）

## 流密码

**流密码：**将明文看作字符串或比特串，并逐字符或逐位进行加密。

优点：速度快

关键：如何生成长且相同的随机密钥流

e.g. Vernam密码：密钥与明文一样长，无统计关系，一次一密

同步流密码数学描述：（PCKLED）

线性返回移位机制可以用于生成伪随机。

- 同步流密码

存在周期问题

- 异步流密码

密钥流z的产生不仅与K有关，还有明文元素有关

自动密钥密码，用前一次加密的明文作为后一次加密的密钥。

------

**流密码分析：**

线性返回移位机制容易受到已知明文攻击。